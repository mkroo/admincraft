# AI로 페이지 만들기

자연어 프롬프트와 OAS3 API 스펙을 기반으로 AI가 어드민 페이지를 자동 생성합니다.

## 사전 준비

- AI API 키가 설정되어 있어야 합니다 ([AI Provider 설정](/configuration/ai-provider) 참고)
- OAS3 스펙이 하나 이상 등록되어 있어야 합니다

## 페이지 생성 과정

### 1. 새 페이지 만들기

사이드바 하단의 **새 페이지 만들기** 버튼을 클릭하고, **AI로 만들기**를 선택합니다.

### 2. API 스펙 선택

등록된 OAS3 스펙 중 사용할 API를 선택합니다.

> **API 스펙 선택 다이얼로그**
>
> - 주문 API (45개 엔드포인트)
> - 회원 API (32개 엔드포인트)
> - 상품 API (28개 엔드포인트)
>
> `[다음]`

::: tip 토큰 절약
전체 OAS3 스펙을 AI에 전달하지 않습니다. 프롬프트의 키워드를 분석하여 관련 엔드포인트와 스키마만 추출합니다. 200개 엔드포인트에서 5개만 추출하면 토큰을 최대 94% 절약할 수 있습니다.
:::

### 3. 프롬프트 입력

원하는 페이지를 자연어로 설명합니다.

**좋은 프롬프트 예시:**

```
주문 목록을 보여주는 페이지를 만들어줘.
주문번호, 주문자명, 주문일시, 금액, 상태를 테이블로 보여주고,
주문번호와 날짜 범위로 검색할 수 있게 해줘.
```

```
회원 상세 정보를 보여주는 페이지를 만들어줘.
회원 기본정보, 주문내역, 포인트 이력을 섹션별로 나눠서 보여줘.
```

```
일별 매출 현황을 보여주는 대시보드를 만들어줘.
오늘 매출, 이번 달 매출을 카드로 보여주고,
아래에 최근 주문 목록 테이블을 넣어줘.
```

### 4. 스트리밍 + 미리보기

AI가 코드를 생성하는 동안 실시간으로 코드가 표시됩니다. 생성이 완료되면 우측에 미리보기가 자동으로 렌더링됩니다.

화면은 좌우 2분할로 구성됩니다:

| 좌측: 코드 에디터 | 우측: 미리보기 |
|:---|:---|
| AI가 코드를 실시간 스트리밍으로 생성 | 스트리밍 완료 후 자동 렌더링 |
| 타이핑 효과로 코드가 한 글자씩 표시 | iframe 샌드박스에서 실제 렌더링 |

에디터 상단의 **환경 드롭다운**(`[DEV ▾]`)으로 API 환경을 전환할 수 있습니다. 미리보기에서 개발 서버의 실제 데이터로 테스트하고, 운영 서버로 전환하여 확인할 수 있습니다. ([API 환경 설정](/configuration/api-environments) 참고)

### 5. 대화형 수정

결과가 마음에 들지 않으면 대화를 이어가며 수정을 요청할 수 있습니다.

```
나: "검색에 주문일시 날짜 범위 필터를 추가해줘"
AI: [수정된 코드 스트리밍...]

나: "상태 컬럼을 뱃지로 바꿔줘. 완료는 초록색, 배송은 파란색"
AI: [수정된 코드 스트리밍...]
```

대화 히스토리는 세션에 저장되어, 나중에 페이지를 편집할 때도 이전 대화를 이어갈 수 있습니다.

### 6. 저장

원하는 결과가 나오면 **저장** 버튼을 클릭합니다.

> **페이지 저장 다이얼로그**
>
> - **제목**: 주문 목록
> - **URL 슬러그**: `order-list`
> - **공개 설정**: 나만 사용 / 갤러리 공개
> - **메뉴에 추가**: 주문 관리 > 주문 목록
>
> `[저장]`

저장 시 서버에서 다음 검증이 수행됩니다:

1. **정적 코드 검증** - 위험 패턴(fetch, eval 등) 포함 여부 확인
2. **import 검증** - 허용된 모듈만 사용하는지 확인
3. **SWC 컴파일** - TSX를 JavaScript로 컴파일

모든 검증을 통과하면 페이지가 저장되고 메뉴에 등록됩니다.

## 기존 페이지 수정

이미 저장된 페이지를 AI로 수정할 수 있습니다.

1. 사이드바에서 페이지를 우클릭하고 **편집** 선택
2. 기존 코드와 이전 AI 대화 히스토리가 로드됨
3. 대화를 이어가며 수정 요청
4. 미리보기 확인 후 저장

## 커스텀 컴포넌트 폴백

설정된 UI 라이브러리에서 제공하지 않는 UI가 필요한 경우, AI가 **커스텀 컴포넌트**를 직접 생성합니다.

### AI가 알아서 판단합니다

타임라인, 간트 차트, 트리뷰 등 기존 컴포넌트로 구현할 수 없는 요청이 들어오면, AI가 자동으로 감지하고 사용자에게 알립니다.

```
⚠️ 요청하신 "타임라인 차트"는 현재 설정된 UI 라이브러리에서 기본 제공하지 않는 UI입니다.

기본 HTML/CSS와 디자인 토큰을 사용하여 커스텀 컴포넌트를 직접 만들겠습니다.
디자인 시스템의 색상과 간격은 그대로 유지됩니다.

계속 진행할까요?
```

사용자가 동의하면, AI는 디자인 토큰(CSS 변수)을 활용하여 기존 UI와 일관된 커스텀 컴포넌트를 생성합니다.

## 생성되는 코드 구조

AI가 생성하는 페이지는 다음 구조를 따릅니다:

```tsx
// Ant Design 프리셋 기준 예시
import { useState, useEffect } from 'react'
import { Table, Card, Space, Input, Button } from 'antd'
import { SearchOutlined } from '@ant-design/icons'
import { useApi } from '@admincraft/hooks'

export default function PageName() {
  const api = useApi()
  // ...상태 관리, 데이터 fetching 로직

  return (
    <Space direction="vertical" size="large" style={{ width: '100%' }}>
      <Card title="페이지 제목">
        {/* 컴포넌트 조합 */}
      </Card>
      <Table columns={[...]} dataSource={data} />
    </Space>
  )
}
```

- 설정된 프리셋의 UI 라이브러리 컴포넌트를 직접 사용합니다
- `@admincraft/hooks`의 `useApi`로 API를 호출합니다
- 직접 `fetch`나 `axios`를 사용하지 않습니다 (보안 정책)
- 기존 컴포넌트로 불가능한 경우, 커스텀 HTML/CSS를 사용합니다

## 제한사항

- AI가 생성한 코드에서 `react`, `react-dom/client`, `@admincraft/hooks`, 프리셋에 등록된 모듈 이외의 모듈은 import할 수 없습니다
- 직접적인 네트워크 요청(`fetch`, `XMLHttpRequest`, `WebSocket`)은 차단됩니다
- `eval`, `new Function` 등 동적 코드 실행은 차단됩니다
- 브라우저 저장소(`localStorage`, `sessionStorage`, `cookie`) 접근은 차단됩니다
